<div class="gestione-password">
    <!-- Step 1: Recupero Password (Email + Codice Fiscale) -->
    <ng-container *ngIf="currentStep === 'forgotPassword'">
      <h2>Recupero Password</h2>
      <form [formGroup]="forgotPasswordForm" (ngSubmit)="submitEmailAndFiscalCode()">
        <!-- Campo Email -->
        <div class="form-group">
          <label for="email">Email</label>
          <input 
            id="email" 
            type="email" 
            class="form-control" 
            placeholder="Inserisci la tua email"
            formControlName="email" 
          />
          <div *ngIf="emailControl.touched && emailControl.invalid" class="error-message">
            <div *ngIf="emailControl.hasError('required')">L'email è obbligatoria</div>
            <div *ngIf="emailControl.hasError('email')">Inserisci un'email valida</div>
          </div>
        </div>
  
        <!-- Campo Codice Fiscale -->
        <div class="form-group">
          <label for="fiscalCode">Codice Fiscale</label>
          <input 
            id="fiscalCode" 
            type="text" 
            class="form-control" 
            placeholder="Inserisci il tuo codice fiscale" 
            formControlName="fiscalCode" 
          />
          <div *ngIf="fiscalCodeControl.touched && fiscalCodeControl.invalid" class="error-message">
            <div *ngIf="fiscalCodeControl.hasError('required')">Il codice fiscale è obbligatorio</div>
          </div>
        </div>
  
        <button type="submit" [disabled]="forgotPasswordForm.invalid">Verifica</button>
      </form>
    </ng-container>
  
    <!-- Step 2: Domanda di Sicurezza -->
    <ng-container *ngIf="currentStep === 'securityQuestion'">
      <h2>Domanda di Sicurezza</h2>
      <p>Nome animaletto?</p>
      <form (ngSubmit)="submitSecurityAnswer()">
        <input 
          type="text" 
          placeholder="Risposta" 
          [(ngModel)]="securityAnswer" 
          name="securityAnswer" 
          required 
        />
        <button type="submit" [disabled]="!securityAnswer">Verifica</button>
      </form>
    </ng-container>
  
    <!-- Step 3: Reimposta Password -->
    <ng-container *ngIf="currentStep === 'resetPassword'">
      <h2>Reimposta Password</h2>
      <form (ngSubmit)="resetPassword()">
        <div class="form-group">
          <label for="newPassword">Nuova Password</label>
          <input 
            id="newPassword" 
            type="password" 
            class="form-control" 
            placeholder="Inserisci la nuova password"
            [(ngModel)]="newPassword" 
            name="newPassword" 
            required 
          />
          <div *ngIf="newPassword && newPassword.length < 6" class="error-message">
            La password deve contenere almeno 6 caratteri
          </div>
        </div>
  
        <div class="form-group">
          <label for="confirmPassword">Conferma Nuova Password</label>
          <input 
            id="confirmPassword" 
            type="password" 
            class="form-control" 
            placeholder="Conferma la nuova password"
            [(ngModel)]="confirmPassword" 
            name="confirmPassword" 
            required 
          />
          <div *ngIf="confirmPassword && confirmPassword !== newPassword" class="error-message">
            Le password non coincidono
          </div>
        </div>
  
        <button 
          type="submit" 
          [disabled]="!newPassword || !confirmPassword || newPassword !== confirmPassword"
        >
          Salva Password
        </button>
      </form>
    </ng-container>
  
    <!-- Step 4: Successo -->
    <ng-container *ngIf="currentStep === 'success'">
      <h2>Password modificata con successo</h2>
      <p>La tua password è stata modificata. Puoi accedere con la nuova password.</p>
      <button (click)="goToStep('login')">Torna al Login</button>
    </ng-container>
  </div>
  